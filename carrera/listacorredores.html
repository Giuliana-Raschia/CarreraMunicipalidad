<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Datos de Corredores</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="./style/style.css" />
</head>

<body>
    <header>
        <h3>V.1.0.0</h3>
        <a href="./index.html" class="btn__volver">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M13 14l-4 -4l4 -4" />
                <path d="M8 14l-4 -4l4 -4" />
                <path d="M9 10h7a4 4 0 1 1 0 8h-1" />
            </svg>
            Volver
        </a>
    </header>

    <section class="contenedor__tabla">
        <h1>Datos de Corredores</h1>
        <table id="corredoresTable">
            <thead>
                <tr id="tableHeader"></tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </section>
    <script>
        async function fetchCorredores() {
            try {
                const response = await fetch("https://ambuvirtual.com/corredores.php");
                const data = await response.json();

                if (Array.isArray(data)) {
                    // Obtener la referencia a los elementos de la tabla
                    const tableHeader = document.getElementById("tableHeader");
                    const tableBody = document.getElementById("tableBody");

                    // Limpiar tabla existente
                    tableHeader.innerHTML = "";
                    tableBody.innerHTML = "";

                    if (data.length > 0) {
                        // Crear encabezados de tabla
                        const headers = Object.keys(data[0]);
                        headers.forEach((header) => {
                            const th = document.createElement("th");
                            th.textContent = header;
                            tableHeader.appendChild(th);
                        });

                        // Crear filas de tabla
                        data.forEach((row) => {
                            const tr = document.createElement("tr");
                            headers.forEach((header) => {
                                const td = document.createElement("td");
                                td.textContent = row[header];
                                tr.appendChild(td);
                            });
                            tableBody.appendChild(tr);
                        });
                    } else {
                        const tr = document.createElement("tr");
                        const td = document.createElement("td");
                        td.colSpan = headers.length;
                        td.textContent = "No hay datos disponibles";
                        tr.appendChild(td);
                        tableBody.appendChild(tr);
                    }
                } else {
                    Swal.fire({
                        title: "Error",
                        text: "Error al cargar los datos.",
                        icon: "error",
                    });
                }
            } catch (error) {
                console.error("Error al cargar los datos:", error);
                Swal.fire({
                    title: "Error",
                    text: "Hubo un problema al cargar los datos.",
                    icon: "error",
                });
            }
        }

        // Llamar a la función para cargar los datos cuando la página se carga
        document.addEventListener("DOMContentLoaded", fetchCorredores);
    </script>
</body>

</html>
